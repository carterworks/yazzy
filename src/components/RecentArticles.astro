---
import { cache } from "../services/cache";

const articleCountAtBuildTime = cache.getArticleCount();
---

<script>
	async function getArticleCount() {
		try {
			const response = await fetch("/api/articles/count");
			const articles = await response.json();
			return articles.count;
		} catch (error) {
			console.error("Failed to get article count", error);
		}
	}
	async function insertRecentCount() {
		const articlesAtRuntime = await getArticleCount();
		const articleDisplay = document.getElementById("article-count");
		if (!articlesAtRuntime || !articleDisplay) {
			return;
		}
		articleDisplay.textContent = articlesAtRuntime;
	}
	insertRecentCount();
</script>
<div>
	There are <span id="article-count">{articleCountAtBuildTime}</span> clipped articles.
</div>
