---
import { version } from "../../package.json" with { type: "json" };

interface Props {
	title?: string;
	classes?: string;
}

const { title = "", classes = "" } = Astro.props;
---

<html lang="en" class="md:text-lg">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="color-scheme" content="light dark" />
		<title>{title}</title>
		<link rel="manifest" href="/manifest.webmanifest" />
		<link rel="icon" href="/scissors.svg" type="image/svg+xml" />
		<link rel="stylesheet" href="/styles.min.css" />
		<script src="/scripts.mjs" type="module" defer async />
		<slot name="head" />
	</head>

	<body class="text-base bg-paper font-geometric-humanist dark:bg-black text-black dark:text-base-200 px-4 py-2 space-y-8 max-w-prose mx-auto">
		<header
			class="flex items-center gap-4 print:hidden"
			style={{ viewTransitionName: "header" }}
		>
			<div class="mr-auto">
				<h1 class="text-2xl font-didone">
					<a
						href="/"
						class="transition-colors rounded hover:bg-base-100 dark:hover:bg-base-800"
					>
						yazzy
					</a>
				</h1>
				<p class="text-xs">Plain ol' reading</p>
			</div>
			<slot name="header" />
		</header>
		<div class={classes}>
			<slot />
		</div>
		<footer
			class="flex justify-between items-start print:hidden"
			style={{ viewTransitionName: "footer" }}
		>
			<ul>
				<li>
					<a
						href="https://github.com/carterworks/yazzy"
						target="_blank"
						rel="noreferrer"
						class="underline transition-colors rounded hover:bg-base-100 dark:hover:bg-base-800"
					>
						Github
					</a>
				</li>
				<li>
					<a
						href="/api/db-dump"
						class="underline transition-colors rounded hover:bg-base-100 dark:hover:bg-base-800"
					>
						Download db dump
					</a>
				</li>
			</ul>
			<div class="text-right">
				<div>v{version}</div>
				<div>
					Article count:{" "}
					<span id="article-count">0</span>
				</div>
			</div>
		</footer>
		<script>
			// Load article count on page load
			fetch('/api/article-count')
				.then(res => res.text())
				.then(count => {
					const el = document.getElementById('article-count');
					if (el) el.textContent = count;
				})
				.catch(() => {});
		</script>
	</body>
</html>

